Figure 3: Overview of layer reconstruction module. At level l, we first upsample the background flows {Vl−1B,j→k} from level l−1 to warp and align the input frames {Ilt} with the keyframe Ilk. We then compute the difference maps between the background-registered frames and the keyframe. The background reconstruction network takes as input the background-registered frames {I~lB,j→k}, the difference maps {DlB,j→k}, the invalid masks {MlB,j→k}, the upsampled background (Bsl−1k)↑2, the reflection layers (Rl−1k)↑2, and learns to predict the residual map of the background keyframe. We add the predicted residual map to the upsampled background frame (Bl−1k)↑2 and produce the reconstructed background frame Blk at level l. For the reflection layer reconstruction, we use the same architecture but learn a different set of network parameters.